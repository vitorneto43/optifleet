<!doctype html>
<html lang="pt-br">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Planos — OptiFleet</title>
<link rel="stylesheet" href="/static/css/site.css">
<style>
  body{background:#0b132b;color:#fff;font-family:system-ui,Arial}
  .wrap{max-width:980px;margin:24px auto;padding:0 16px}
  .grid{display:grid;gap:16px;grid-template-columns:1fr 1fr}
  .card{background:#1c2541;border-radius:14px;padding:18px;box-shadow:0 10px 28px rgba(0,0,0,.28)}
  .card h3{margin:0 0 4px}
  .muted{color:#a0aec0}
  .price{font-size:28px;font-weight:700;margin:4px 0}
  .row{display:flex;gap:10px;align-items:center;margin-top:12px}
  .btn{padding:10px 14px;border-radius:10px;border:0;background:#3a86ff;color:#fff;cursor:pointer;text-decoration:none;display:inline-block}
  .switch{display:flex;gap:8px;align-items:center;margin:16px 0}
  input[type=number], select{padding:8px;border-radius:10px;border:0}
  .badge{background:rgba(255,255,255,.1);padding:4px 8px;border-radius:999px;font-size:12px}
</style>
</head>
<body>
<div class="wrap">
  <h1>Planos</h1>
  <p class="muted">Mensal fixo (R$ 399 e R$ 1499). Anual com <b>{{ (annual_discount*100)|round(0)|int }}% OFF</b> no total.</p>

  <div class="grid">
    <!-- START -->
    <div class="card">
      <h3>{{ plans['start']['name'] }} <span class="badge">até {{ plans['start']['max_vehicles'] }} veículos</span></h3>
      <div class="price">{{ fmt(plans['start']['monthly']) }} <span class="muted">/mês</span></div>
      <div class="muted">Anual: {{ fmt(plans['start']['annual']) }} <span class="muted">(total/ano)</span></div>

      <div class="switch">
        <label for="v-start">Veículos</label>
        <input id="v-start" type="number" min="1" max="{{ plans['start']['max_vehicles'] }}" value="5" style="width:90px">
        <select id="b-start">
          <option value="monthly" selected>Mensal</option>
          <option value="annual">Anual (-{{ (annual_discount*100)|round(0)|int }}%)</option>
        </select>
      </div>

      <div class="row">
        <a class="btn"
           href="{{ url_for('billing.go_checkout', plan='start', billing='monthly', vehicles=5) }}">
           Contratar
        </a>
        <a class="btn"
           href="{{ url_for('billing.go_checkout', plan='start', billing='annual', vehicles=5) }}">
          Contratar Start Anual
        </a>

        <span class="muted">Pagamento no Asaas</span>
      </div>

    </div>

    <!-- PRO -->
    <div class="card">
      <h3>{{ plans['pro']['name'] }} <span class="badge">até {{ plans['pro']['max_vehicles'] }} veículos</span></h3>
      <div class="price">{{ fmt(plans['pro']['monthly']) }} <span class="muted">/mês</span></div>
      <div class="muted">Anual: {{ fmt(plans['pro']['annual']) }} <span class="muted">(total/ano)</span></div>

      <div class="switch">
        <label for="v-pro">Veículos</label>
        <input id="v-pro" type="number" min="1" max="{{ plans['pro']['max_vehicles'] }}" value="5" style="width:90px">
        <select id="b-pro">
          <option value="monthly" selected>Mensal</option>
          <option value="annual">Anual (-{{ (annual_discount*100)|round(0)|int }}%)</option>
        </select>
      </div>

      <div class="row">
          <a class="btn"
             href="{{ url_for('billing.go_checkout', plan='pro', billing='monthly', vehicles=5) }}">
             Contratar
          </a>
          <a class="btn"
             href="{{ url_for('billing.go_checkout', plan='pro', billing='annual', vehicles=5) }}">
             Contratar Pro Anual
          </a>

          <span class="muted">Pagamento no Asaas</span>
      </div>

    </div>
  </div>

  <div style="margin-top:16px">
    <a href="{{ url_for('home') }}" class="btn" style="background:transparent;border:1px solid rgba(255,255,255,.25)">← Voltar</a>
  </div>
</div>

<script>
function go(plan){
  const v = document.getElementById(`v-${plan}`).value || 5;
  const b = document.getElementById(`b-${plan}`).value || 'monthly';
  const url = new URL('{{ url_for("billing.go_checkout") }}', window.location.origin);
  url.searchParams.set('plan', plan);
  url.searchParams.set('billing', b);
  url.searchParams.set('vehicles', v);
  window.location.href = url.toString();
}
</script>
</body>
</html>
